# Demo showing columns feature
# Steps produce resources, columns compute values for each resource
# Each column is bound to a specific resource by name

[[step]]
name = "extract"
script = '''
echo "hello world" > $OUTPUT_DIR/data
echo "second item" > $OUTPUT_DIR/data
'''

# Column that counts characters in the resource data
# Bound to the "data" resource
[[column]]
name = "char_count"
resource = "data"
script = '''
wc -c < $INPUT_DIR/data > $OUTPUT_DIR/char_count
'''

# Column that converts to uppercase
# Also bound to the "data" resource
[[column]]
name = "uppercase"
resource = "data"
script = '''
tr '[:lower:]' '[:upper:]' < $INPUT_DIR/data > $OUTPUT_DIR/uppercase
'''

# Column that combines results from other columns
# Has dependencies on char_count and uppercase
[[column]]
name = "summary"
resource = "data"
dependencies = ["char_count", "uppercase"]
script = '''
echo "Character count: $(cat $INPUT_DIR/char_count)" > $OUTPUT_DIR/summary
echo "Uppercase: $(cat $INPUT_DIR/uppercase)" >> $OUTPUT_DIR/summary
'''
